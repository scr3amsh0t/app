{% extends "main/base.html" %}

{% load static %}

{% block styles %}
<link rel="stylesheet" href="{% static "deps/styles/account.css" %}" />
{% endblock styles %}

{% block wall %}
<div class="wall">
    <form id="accountForm" method="POST">
        {% csrf_token %}
      <div>
        <p class="input-text">Вставьте ссылку на аккаунт:</p>
        <input type="text" class="form-control" id="textInput" style="font-size: 20px;" placeholder="https://vk.com/example"
         value="https://vk.com/" pattern="https://vk.com/.*" required>
      </div>
      <div>
        <p class="help-text">Выберите варианты поиска:</p>
        <ul>
          <li>
            <label><input type="checkbox" id="checkbox1" name="checkbox1">Получить краткую информацию</label>
          </li>
          <li>
            <label><input type="checkbox" id="checkbox2" name="checkbox2">Анализировать посты</label>
          </li>
          <li>
            <label><input type="checkbox" id="checkbox3" name="checkbox3">Анализировать комментарии на странице</label>
          </li>
        </ul>
      </div>
      <div>
        <p class="help-text">Выберите форматы представления данных:</p>
        <ul>
            <li>
              <label><input type="checkbox" id="checkbox4" name="checkbox4">TXT</label>
            </li>
            <li>
              <label><input type="checkbox" id="checkbox5" name="checkbox5">XLSX</label>
            </li>
            <li>
              <label><input type="checkbox" id="checkbox6" name="checkbox6">XML</label>
            </li>
          </ul>
      </div>
      <div>
        <button class="btn btn-outline-secondary" type="submit" id="submitButton">Отправить</button>
      </div>
    </form>
  </div> 

  <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <script>
    {% comment %} $(document).ready(function() {
        function get_account_info() {
            $.ajax({
                url: "",
                type: "POST",
                data: {},
                success: function(response) {
                
                    console.log(response);
                },
                error: function(xhr, status, error) {
                    
                    console.error(error);
                }
            });
        }
        
        function get_posts() {
            $.ajax({
                url: "/scripts/posts.py", 
                type: "POST",
                data: {},
                success: function(response) {
                    
                    console.log(response);
                },
                error: function(xhr, status, error) {
                    
                    console.error(error);
                }
            });
        }
        
        function get_comments() {
            $.ajax({
                url: "/scripts/comments.py", 
                type: "POST",
                data: {},
                success: function(response) {
                    
                    console.log(response);
                },
                error: function(xhr, status, error) {
                    
                    console.error(error);
                }
            });
        } {% endcomment %}
        
        $("#accountForm").submit(function(event) {
            event.preventDefault();
            
            var inputText = $("#textInput").val();
            
            if(inputText === "https://vk.com/") {
                alert("Пожалуйста, введите данные");
                return;
            }
            
            if(!$("#checkbox1").is(":checked") && !$("#checkbox2").is(":checked") && !$("#checkbox3").is(":checked")) {
                alert("Выберите хотя бы один вариант поиска");
                return;
            }

            if(!$("#checkbox4").is(":checked") && !$("#checkbox5").is(":checked") && !$("#checkbox6").is(":checked")) {
                alert("Выберите хотя бы один формат импорта данных");
                return;
            }
            
            if($("#checkbox1").is(":checked")) {
                get_account_info();
            }
            if($("#checkbox2").is(":checked")) {
                get_posts();
            }
            if($("#checkbox3").is(":checked")) {
                get_comments();
              }
          });
        });
    </script>

{% endblock  %}